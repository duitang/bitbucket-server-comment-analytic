<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}" />
    </plugin-info>

    <component-import key="git-scm" interface="com.atlassian.stash.scm.git.GitScm" />

    <component key="archive-service" class="com.atlassian.stash.archive.DefaultArchiveService" public="true">
        <interface>com.atlassian.stash.archive.ArchiveService</interface>
    </component>

    <rest key="archive-rest" path="/archive" version="1.0">
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>FORWARD</dispatcher>
        <init-param>
            <param-name>extension.filter.excludes</param-name>
            <param-value>.*</param-value>
        </init-param>
        <package>com.atlassian.stash.archive.rest</package>
    </rest>

    <web-resource key="archive-resources" name="archive-resources">
        <resource type="download" name="style.css" location="/static/style.css"/>
        <resource type="download" name="archive.js" location="/static/archive.js"/>
        <resource type="download" name="icon-archive.png" location="/static/icon-archive.png"/>
        <context>stash.layout.repository</context>
        <dependency>com.atlassian.stash.stash-web-plugin:global</dependency>
    </web-resource>

    <web-panel key="stash-repository-download-archive" name="Download archive" weight="10"
               location="stash.web.repository.clone.before">
        <resource name="view" type="velocity" location="/static/archive-button.vm"/>
        <dependency>com.atlassian.stash.stash-web-plugin:global</dependency>
    </web-panel>

</atlassian-plugin>
